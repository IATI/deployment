<VirtualHost {{apache2_ip}}:{{apache2_port}}>
  ServerAdmin webmaster@localhost
  {% if apache2_documentroot is defined %}
  DocumentRoot {{apache2_documentroot}}
  {% endif %}

  ErrorLog ${APACHE_LOG_DIR}/error.log
  CustomLog ${APACHE_LOG_DIR}/access.log combined

  {% for directory in apache2_directories %}
    {% if directory.alias is defined %}
  Alias {{directory.alias.source}} {{directory.alias.destination}}
    {% endif %}
  <Directory {{directory.root}}>
    {% if directory.file is defined %}
    <Files {{directory.file.location}}>
      {% if directory.file.options is defined%}
        {% for option in directory.file.options %}
      {{option.line}}
        {% endfor %}
      {% endif %}
      Require all granted
    </Files>
    {% else %}
    {% if directory.options is defined%}
      {% for option in directory.options %}
    {{option.line}}
      {% endfor %}
    {% endif %}
    Require all granted
    {% endif %}
  </Directory>
  {% endfor %}

  {% for apache2_extra in apache2_extras %}
  {{apache2_extra.line}}
  {% endfor %}
</VirtualHost>
